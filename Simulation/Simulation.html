<!DOCTYPE html>
<html>
<head>
    <!-- <meta charset= "utf-8"> -->
    <title>Newton-Raphson Method</title>
    
    
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=default'></script>
    <style>
        .panel-title{
            color: #a94442;
            font-weight: bold;
            font-size: large;
        }
        
        .panel-heading{
            background-color: rgb(118, 230, 238);
        }
        .panel-answer{
            background-color: rgb(118, 230, 238);
        }
        .panel-body{
            color: #000000;
            background-color: #f2dede;
        }
        
        .kkk{
            color: #050505;
            background-color: rgb(236, 241, 241);
        }
        
        .panel-text-heading{
            background-color: rgb(216, 219, 219);
        }
        .panel-text-title{
            color: #000000;
            font-weight: bold;
            font-size: large;
        }
        #myBtn {
            display: none;
            position: fixed;
            bottom: 20px;
            right: 30px;
            z-index: 99;
            font-size: 18px;
            border: none;
            outline: none;
            background-color: rgb(101, 166, 226);
            color: white;
            cursor: pointer;
            padding: 15px;
            border-radius: 4px;
            }

        #myBtn:hover {
            background-color: #555;
        }
    </style>

    </head>
<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    

    <button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>


    <div class= "container">
      <!-- panel -->
        <div class="panel panel-col-pink">
            <div class="panel-text-heading" role="tab" id="headingOne_1">
                <p class="panel-text-title">
                    
                        
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Newton-Raphson Method
                    
                </p>
            </div>
            
            <div class="kkk">
                <div class="col-md-12">
                    <div class="col-md-4">
                        <img src="newton-rhapson.jpeg" class="img-responsive thumbnail" style="
                                margin-left: auto;
                                margin-right: auto;
                                display: block;" alt="Trulli" >
                        <sup>  source: internet </sup>
                       
                    </div>
                    
                    <div class="col-md-8">
                        <p> 
                            In numerical analysis, 
                            <b>Newton's method</b>, also known as the <b>Newton–Raphson method</b>, named after 
                            Isaac Newton and Joseph Raphson
                            , is a root-finding algorithm 
                            which produces successively better approximations to the 
                            roots (or zeroes) of a 
                            real-valued function. 
                            The most basic version starts with a single-variable function <span class="texhtml"><i>f</i></span> defined for a 
                            real variable
                            <span class="texhtml"><i>x</i></span>, the function's derivative
                            <span class="texhtml"><i>f&thinsp;′</i></span>, and an initial guess <span class="texhtml"><i>x</i><sub>0</sub></span> for a 
                            root of <span class="texhtml"><i>f</i></span>. <br>
                            
                            <sup>  source: <a href=" https://en.wikipedia.org/wiki/Newton%27s_method"> https://en.wikipedia.org/wiki/Newton%27s_method </a> </sup>

                        </p> 
                        <p>
                            In this case the <b>Newton's method</b> is aplayed to calculate electrical quantities of non-linear electronic devices. The use of this method is 
                            justified due it's accuracy as also the possibility of function divergence of a non-linear devices equations calculated by standart numerical analysis.

                        </p>
                    </div>
                   
                                
                                                
                   
                </div> 
            </div> 
            
            <p>&nbsp;</p>
            
            <div class="panel-text-heading" role="tab" id="headingOne_1">
                <p class="panel-text-title">
                    
                        
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Nod-linear Devices
                    
                </p>
            </div>
            
            <div class="kkk">
                <div class="col-md-12">
                    <div class="col-md-4">
                        <img src="diode.jpg" class="img-responsive thumbnail" style="
                                margin-left: auto;
                                margin-right: auto;
                                display: block;" alt="Trulli" >
                        <sup>  source: internet </sup>
                        
                        
                        <p>&nbsp;</p>
                        
                        <img src="fic.png" class="img-responsive thumbnail" style="
                        margin-left: auto;
                        margin-right: auto;
                        display: block;" alt="Trulli" >
                         
                         <sup>  source: autor collection </sup>
                        
                       
                    
                    
                    </div>
                    
                    <div class="col-md-8">
                        <p> 
                            One of the study objects is the diode a bipolar electronic device that follows the equation:

                            
                            $$ { I_{d} =I_{s}(e^{V_{d}/ \eta V_{t} } - 1)} $$

                        </p> 
                        <p> 
                            
                            In olther hand is also studied a generic device that follows the equation:
                            
                            $$ { I_{d} =1.3V_{d}^{3} -0.2V_{d}^{2}  } $$
                        </p> 
                    </div>
                   
                                
                                                
                   
                </div> 
            </div> 
            
            <p>&nbsp;</p>
            
            <div class="jumbotron"> 
                <div class="panel-heading" role="tab" id="headingOne_1">
                    <p class="panel-title">
                        
                            
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Diod Simulation using Newton-Raphson Method
                        
                    </p>
                </div>
                <div class="panel-body">
                    <div class="col-md-12">
                    
                        <div class="row clearfix">
                            <div class="col-md-4">
                                <img src="diodo.gif" class="img-responsive thumbnail" style="
                                    margin-left: auto;
                                    margin-right: auto;
                                    display: block;" alt="Trulli" >
                                <div class="">
                                    <label for="Vt"> Vt </label>
                                    <input type="number" class="form-control" step=".01" id="Vt" value="0.0256927355" readonly> 
                                </div >
                            </div>
                            
                            <div class="col-md-8 align-center ">
                        
                                        <label for="temp">  Simulation Temp. (°C):  </label>
                                        <input type="number" class="form-control" step="" id="temp" value="25" >

                                        <label for="R1"> R1 (Ohm): </label>
                                        <input type="number" class="form-control" step=".01" id="R1" value="50">
                                        
                                        <label for="Vin"> Vss (V): </label>
                                        <input type="number" class="form-control" step=".01" id="Vin" value="0.7840684">
                                
                                        <label for="eta"> η: </label>
                                        <input type="number" class="form-control" step=".01" id="eta" value="1">
                                
                                
                                
                                <div class="form-row">
                                    <div class="form-group col-md-5"> 
                                        <label for="Is">  Is(A): </label>
                                        <input type="number" class="form-control" step=".01" id="Is" value="1.091062">
                                    </div>
                                    <div class="form-group col-md-2"> 
                                        <label for="z"> &nbsp; </label>
                                        <input type="character" class="form-control" step=".01" id="z" value="x 10 ^" readonly> 
                                    </div>
                                    <div class="form-group col-md-5"> 
                                        <label for="pot">  &nbsp; </label>
                                        <input type="number" class="form-control" step=".01" id="pot" value="-16">
                                    </div>
                                    
                                </div>
                                    
                                <div class="form-row">
                                    <div class="form-group col-md-6"> 
                                        <button onclick="validateForm()" class= "btn btn-primary btn-lg" >Run</button>
                                    </div>
                                    
                                    <div class="form-group col-md-6"> 
                                        <div class="form-row">
                                            <!-- <div class="form-group col-md-6"> 
                                            
                                                <label for="pet-select">Choose tab size:</label>

                                                <select name="pets" id="pet-select" readonly>
                                                    
                                                    <option value="">-- ALL --</option>
                                                    <option value="dog">Last 20</option>
                                                    <option value="cat">Last 30</option>
                                                    <option value="hamster">Last 50</option>
                                                    <option value="parrot">Last 100</option>
                                                    
                                                </select>
                                                
                                            </div> -->
                                            <div class="form-group col-md-6"> 
                                            
                                                <button onclick="cleartab()" class= "btn btn-primary btn-lg" >Clear Tab</button>
                                                
                                            </div>
                                            
                                        
                                        
                                        </div>    
                                    </div>
                                </div>        
                                
                                
                            </div>
                        </div>
                    </div> 
                </div> 

                <p>
                    &nbsp;
                </p>
                
                <div class="panel-answer" role="tab" id="">               
                        
                    <div class="form-row">   
                        <div class="col-md-12">
                            <div class="col-md-4">
                                <h4> Diod Voltage  =  <p id= "Vdr"> </p>   </h4>
                            </div>
                            <div class="col-md-4">
                                <h4> Diod current = <p id= "Ic">  </p>  </h4>  
                            </div>
                            <div class="col-md-4">
                                <h4> Iterations = <p id= "contador">  </p>  </h4>
                            </div>
                        </div>
                    </div>
                </div> 
               
            
                
                    <div class="panel-body">
                        <div class="table-responsive" style="height: 100%; width: 100%">
                            <table class="table table-bordered table-striped table-hover dataTable js-exportable align-center">
                                <thead>
                                    <tr>
                                        <th>Iteration</th>
                                        <th>Diode Voltage (V) </th>
                                        <th>Diode Current (A)</th>
                                        
                                    </tr>
                                </thead>
                                
                                <tfoot>
                                </tfoot>
                                
                                <tbody id="tabela"> 
                                    
                                </tbody>
                            </table>
                        </div>
                    </div>
                
            </div> 


            <p>
                &nbsp;

            </p>


            <div class="jumbotron"> 
                <div class="panel-heading" role="tab" id="headingOne_1">
                    <p class="panel-title">
                        
                            
                        &nbsp;&nbsp;&nbsp;  Device Simulation using Newton-Raphson Method
                        
                    </p>
                </div>
                
                <div class="panel-body">
                    <div class="col-md-12">
                    
                        <div class="row clearfix">
                            <div class="col-md-4 align-center ">
                                <img src="device.png" class="img-responsive thumbnail" style="
                                margin-left: auto;
                                margin-right: auto;
                                display: block;" alt="Trulli" >

                            </div>
                            
                            <div class="col-md-8 align-center ">
                        
                                        
                                        <label for="R1"> R1 (Ohm): </label>
                                        <input type="number" class="form-control" step=".01" id="R1_f" value="1000">
                                        
                                        <label for="Vin"> Vdc (V): </label>
                                        <input type="number" class="form-control" step=".01" id="Vin_f" value="1">
                                
                                        
                                
                                
                                
                                
                                    
                                <p>
                                    &nbsp;
                    
                                </p>
                                <div class="form-row">
                                    <div class="form-group col-md-6"> 
                                        <button onclick="validateForm2()" class= "btn btn-primary btn-lg" >Run</button>
                                    </div>
                                    
                                    <div class="form-group col-md-6"> 
                                        <div class="form-row">
                                            
                                            <div class="form-group col-md-6"> 
                                            
                                                <button onclick="cleartab2()" class= "btn btn-primary btn-lg" >Clear Tab</button>
                                                
                                            </div>
                                            
                                        
                                        
                                        </div>    
                                    </div>
                                </div>        
                                
                                
                            </div>
                        </div>
                    </div> 
                </div> 

                <p>
                    &nbsp;

                </p>
                <div class="panel-answer" role="tab" id="">               
                        
                    <div class="form-row">   
                        <div class="col-md-12">
                            <div class="col-md-4">
                                <h4> Device Voltage  =  <p id= "Vf"> </p>   </h4>
                            </div>
                            <div class="col-md-4">
                                <h4> Device current = <p id= "If">  </p>  </h4>  
                            </div>
                            <div class="col-md-4">
                                <h4> Iterations = <p id= "contador_f">  </p>  </h4>
                            </div>
                        </div>
                    </div>
                </div> 
                
                <div class="form-row">  
                    <div class="col-md-12">
                        <div class="panel-body">
                            <div class="table-responsive" style="height: 100%; width: 100%">
                                <table class="table table-bordered table-striped table-hover dataTable js-exportable align-center">
                                    <thead>
                                        <tr>
                                            <th>Iteration</th>
                                            <th>Device Voltage (V) </th>
                                            <th>Device Current (A)</th>
                                            
                                        </tr>
                                    </thead>
                                    
                                    <tfoot>
                                    </tfoot>
                                    
                                    <tbody id="tabela_2"> 
                                        
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <p>
                &nbsp;

            </p>
            <p>
                &nbsp;

            </p>
        
        </div>
    
        
            
                
            
        <!-- panel -->
        
      
            
        
            <!-- <div id="tab" class="panel-collapse collapse in"  style="background-color: rgb(255,255,255);" role="tabpanel" aria-labelledby="retorno_aquisicao_collapse_mes">
                <div class="panel-body">
                    <div class="table-responsive" style="height: 100%; width: 100%">
                        <table class="table table-bordered table-striped table-hover dataTable js-exportable align-center">
                            <thead>
                                <tr>
                                    <th>Iteration</th>
                                    <th>Diode Voltage (V) </th>
                                    <th>Diode Current (A)</th>
                                    
                                </tr>
                            </thead>
                            
                            <tfoot>
                            </tfoot>
                            
                            <tbody id="tabela"> 
                                
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>  -->
        
        
        
        
       
        
        
     
     
    
    </div>



    <script>
        
        //var Vin = 0.7840684;
        //var Is =  1.091062*Math.pow(10,-16);
        // var Vt = 0.0256927355;
        Vt = ((25  + 273.15) * (1.380649*Math.pow(10,-23)))/ (1.602*Math.pow(10,-19)) 
        // var eta = 1;
        var Vr = []    
        
        // $(document).ready(function(){
        //     $("Vd").change(function(){
        //         Newton(Vd);
                
        //     });
        // });
        $(document).ready(function(){
                
                $("#temp").change(function(){
                    var T = parseInt(document.getElementById("temp").value);
                    var  Vt = ((T  + 273.15) * (1.380649*Math.pow(10,-23)))/ (1.602176634*Math.pow(10,-19)) 
                    
                    document.getElementById("Vt").value = Vt
                });
            });
        
        
        
        function validateForm() {
            var Vd = 0.75;
            var R1 = document.getElementById("R1").value;
            var Vin = document.getElementById("Vin").value;
            var eta = document.getElementById("eta").value;
            
            var It = document.getElementById("Is").value;
            var pot = document.getElementById("pot").value;
            
            var Temp = parseInt(document.getElementById("temp").value);
            
            console.log(Temp)
            
            var Vt = (( Temp  + 273.15) * (1.380649*Math.pow(10,-23)))/ (1.602176634*Math.pow(10,-19)) 
            
            console.log(Vt)

            
            var Is =  It*Math.pow(10,pot);
            
           
            
            Newton(Vd,R1,Vin,eta,Is,Vt);
        }
        



        function Id(Vd,R1,Vin,eta,Is,Vt){
            
            var K = (Is*Math.exp(Vd/(eta*Vt)))/Is
            var Idi = (Vin) - (R1*Is*Math.exp(Vd/(eta*Vt))) - eta*Vt*Math.log(K)

            
            
            
            return Idi;
        } 
        function Id2(Vd,R1,Vin,eta,Is,Vt){
            
            var Idi2 = - (R1*Is*Math.exp(Vd/(eta*Vt)))/(eta * Vt);

            

            
            return Idi2;
        } 

        function Newton(Vd,R1,Vin,eta,Is,Vt){
            Vr = [];
            Ir = [];

            for(var i = 0; i <= 500; i++){
                var fxn = 0;
                var Dfxn = 0;
                var contador
               
                if(i == 500){
                    alert("Limite de iterações")
                }
                console.log("vd " + Vd)
                
                f =  Is*(Math.exp(Vd/(Vt*eta))-1) - Vin/R1 + Vd/R1 ;
                
                console.log("f " + f)

                df = (Is/(eta*Vt))*Math.exp(Vd/(Vt*eta)) + 1/R1;
                
                console.log("df " + df)
                
                Vd = Vd - f/df;
                
                Vr[i] = Vd;
                Ir[i] = Is*(Math.exp(Vd/(Vt*eta)) -1);
                
                if(i > 1){
                    var erro = Vr[ (i - 1) ] - Vr[ (i) ];
                    
                    erro = Math.abs(erro);
                    if( erro <= 0.0000001 ){
                        
                        break;
                    
                    }

                }

                
                if(isNaN(Vr[i])){
                        alert("O critério de Newthon Rhapson divergiu para este setup")
                        break
                    }

                    contador = i;
                    
                    
                     
            
            }
            
            var Ic = Is*(Math.exp(Vd/(Vt*eta)))
            document.getElementById("Vdr").innerHTML = Vr[(Vr.length - 1)] + " V";
            document.getElementById("Ic").innerHTML = Ic + " A";
            document.getElementById("contador").innerHTML = (Vr.length - 1);
            
            tab(Vr,Ir);
            
            
            
        }

        function tab ( Vr, Ir ){
               

              for(var i = 0; i <= Vr.length -1 ; i++) {
                $('#tabela').append(`
                    <tr>
                        <td>${i}</td>
                        <td>${Vr[i]}</td>
                        <td class="fluxo_caixa"> ${Ir[i]} </td>
                        
                    </tr>
                
                `); 

            }
        
            var tamanho_tabela = document.getElementById("tabela").childElementCount;
            // console.log("tamanho tabela = " + tamanho_tabela)
            tabela_retorno_aquisição  = document.getElementById("tabela")
            var diferença = tamanho_tabela - (Vr.length )
            // console.log("deferença = " + diferença)
            if( diferença > 0 ){
                    
                    for(i=0; i < diferença; i++ ){
                        
                        tabela.removeChild(tabela.children[0]);
                    
                    }
            }
        
        }
        
        function cleartab (){
            while(tabela.firstChild)  { 
                tabela.removeChild(tabela.firstChild);
            }

        }
       
        
        function validateForm2() {
            var Vd = 1;
            var R1 = document.getElementById("R1_f").value;
            var Vin = document.getElementById("Vin_f").value;
            

            
            
            
           
            
            Newton2(Vd,R1,Vin);
        }
        
        function Newton2(Vd,R1,Vin){
            Vr = [];
            Ir = [];

            for(var i = 0; i <= 500; i++){
                var fxn = 0;
                var Dfxn = 0;
                var contador
               
                if(i == 500){
                    alert("Limite de iterações")
                }
                console.log("vd " + Vd)
                
                f =  1.3*Math.pow(Vd,3) - 0.2*Math.pow(Vd,2) - Vin/R1 + Vd/R1;
                
                console.log("f " + f)

                df =  3*1.3*Math.pow(Vd,2) - 0.4*Vd + 1/R1;
                
                console.log("df " + df)
                
                Vd = Vd - f/df;
                
                Vr[i] = Vd;
                Ir[i] = 1.3*Math.pow(Vd,3) - 0.2*Math.pow(Vd,2);
                
                if(i > 1){
                    var erro = Vr[ (i - 1) ] - Vr[ (i) ];
                    
                    erro = Math.abs(erro);
                    if( erro <= 0.0000001 ){
                        
                        break;
                    
                    }

                }

                
                if(isNaN(Vr[i])){
                        alert("O critério de Newthon Rhapson divergiu para este setup")
                        break
                    }

                    contador = i;
                    
                    
                     
            
            }
            
            var Ic = Is*(Math.exp(Vd/(Vt*eta)))
            document.getElementById("Vf").innerHTML = Vr[(Vr.length - 1)] + " V";
            document.getElementById("If").innerHTML = Ir[(Ir.length - 1)] + " A";
            document.getElementById("contador_f").innerHTML = (Ir.length - 1);
            
            tab2(Vr,Ir);
            
            
            
        }
        
        function tab2 ( Vr, Ir ){
               

               for(var i = 0; i <= Vr.length -1 ; i++) {
                 $('#tabela_2').append(`
                     <tr>
                         <td>${i}</td>
                         <td>${Vr[i]}</td>
                         <td> ${Ir[i]} </td>
                         
                     </tr>
                 
                 `); 
 
             }
         
             var tamanho_tabela = document.getElementById("tabela_2").childElementCount;
             // console.log("tamanho tabela = " + tamanho_tabela)
             tabela_retorno_aquisição  = document.getElementById("tabela_2")
             var diferença = tamanho_tabela - (Vr.length )
             // console.log("deferença = " + diferença)
             if( diferença > 0 ){
                     
                     for(i=0; i < diferença; i++ ){
                         
                         tabela_2.removeChild(tabela_2.children[0]);
                     
                     }
             }
         
         }
         function cleartab2 (){
            while(tabela_2.firstChild)  { 
                tabela_2.removeChild(tabela_2.firstChild);
            }

        }
        
        var mybutton = document.getElementById("myBtn");

        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = function() {scrollFunction()};

        function scrollFunction() {
        if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
            mybutton.style.display = "block";
        } else {
            mybutton.style.display = "none";
        }
        }

        // When the user clicks on the button, scroll to the top of the document
        function topFunction() {
        document.body.scrollTop = 0;
        document.documentElement.scrollTop = 0;
        }
        
    </script>
</body>
</html>